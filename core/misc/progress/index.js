!function(t,a){a.theme.progressBar=function(s){return'<div id="'+s+'" class="progress" aria-live="polite"><div class="progress__label">&nbsp;</div><div class="progress__track"><div class="progress__bar"></div></div><div class="progress__percentage"></div><div class="progress__description">&nbsp;</div></div>'},a.ProgressBar=function(s,e,r,i){this.id=s,this.method=r||"GET",this.updateCallback=e,this.errorCallback=i,this.element=t(a.theme("progressBar",s))},t.extend(a.ProgressBar.prototype,{setProgress:function(s,e,r){0<=s&&s<=100&&(t(this.element).find("div.progress__bar").css("width",s+"%"),t(this.element).find("div.progress__percentage").html(s+"%")),t("div.progress__description",this.element).html(e),t("div.progress__label",this.element).html(r),this.updateCallback&&this.updateCallback(s,e,this)},startMonitoring:function(s,e){this.delay=e,this.uri=s,this.sendPing()},stopMonitoring:function(){clearTimeout(this.timer),this.uri=null},sendPing:function(){if(this.timer&&clearTimeout(this.timer),this.uri){var r=this,s=this.uri;-1===s.indexOf("?")?s+="?":s+="&",s+="_format=json",t.ajax({type:this.method,url:s,data:"",dataType:"json",success:function(s){0!==s.status?(r.setProgress(s.percentage,s.message,s.label),r.timer=setTimeout(function(){r.sendPing()},r.delay)):r.displayError(s.data)},error:function(s){var e=new a.AjaxError(s,r.uri);r.displayError("<pre>"+e.message+"</pre>")}})}},displayError:function(s){var e=t('<div class="messages messages--error"></div>').html(s);t(this.element).before(e).hide(),this.errorCallback&&this.errorCallback(this)}})}(jQuery,Drupal);